(this.webpackJsonpxvoiceproject=this.webpackJsonpxvoiceproject||[]).push([[0],{18:function(e,t,a){e.exports=a(45)},23:function(e,t,a){},24:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},25:function(e,t,a){},45:function(e,t,a){"use strict";a.r(t);var n,o=a(0),s=a.n(o),l=a(12),i=a.n(l),r=(a(23),a(13)),c=a(14),m=a(16),d=a(15),u=a(17),g=a(2),h=(a(24),a(25),a(26)),p=window.location;n=p.host.includes(":")?p.host.substring(0,p.host.length-5):p.host;var E=p.protocol+"//"+n+":8181/",v=a(27);v.defaults.xsrfCookieName="csrftoken",v.defaults.xsrfHeaderName="X-CSRFToken",v.defaults.withCredentials=!1;var w={id:1,apiUsageHistory:[],recargasHistory:[],usageHistory:Array(2),0:{id:1,method:"INVITE",from_tag:"182c4d3c",to_tag:"as20b73407",callid:"cEkRV392kx6FSq3oqmdIZA..",sip_code:"200",sip_reason:"OK",time:"2020-02-18T02:58:05Z",src_user:"4776200196",src_domain:"3.81.8.219",src_ip:"201.229.162.40",dst_ouser:"15612402968",dst_user:"15612402968",dst_domain:"64.2.142.93",consumer:1},1:{id:2,method:"BYE",from_tag:"182c4d3c",to_tag:"as20b73407",callid:"cEkRV392kx6FSq3oqmdIZA..",sip_code:"200",sip_reason:"OK",time:"2020-02-18T02:58:12Z",src_user:"4776200196",src_domain:"3.81.8.219",src_ip:"201.229.162.40",dst_ouser:"15612402968",dst_user:"15612402968",dst_domain:"66.241.97.51",consumer:1},length:2,__proto__:Array(0),subscribers:[{id:2,username:"4776200196",password:"Pri3to"}],password:"pbkdf2_sha256$180000$ssnEgRIWpT23$zXiLCGZD+tQDLSBkzSfuQog2+fKp5F6KvbGu4s92nnE=",last_login:"2020-02-18T02:43:12.790044Z",is_superuser:!0,username:"prieto",first_name:"",last_name:"",email:"prieto@admin.com",is_staff:!0,is_active:!0,date_joined:"2020-02-18T02:28:36.782698Z",name:null,balance:"-0.001",phoneNumber:null,groups:[],user_permissions:[]},f=function(e){return s.a.createElement(s.a.Fragment,null,s.a.createElement("li",null,s.a.createElement("a",{className:"navTitle",onClick:function(){e.userPack.handleLogout()},href:"#"},"Logout")))},b=function(e){return s.a.createElement(s.a.Fragment,null,s.a.createElement("tr",null,s.a.createElement("td",null,e.username),s.a.createElement("td",null,e.password),s.a.createElement("td",null,"-")))},_=function(e){return s.a.createElement(s.a.Fragment,null,s.a.createElement("tr",null,s.a.createElement("td",null,e.line.username),s.a.createElement("td",null,e.line.destination),s.a.createElement("td",null,e.line.date),s.a.createElement("td",null,e.line.duracion),s.a.createElement("td",null,e.line.costo)))},k=function(e){var t=s.a.useState(!1),a=Object(g.a)(t,2),n=a[0],o=a[1],l=e.dimensions.width<768;return s.a.createElement(s.a.Fragment,null,s.a.createElement("header",{className:"header"},l?s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:n?"burguer change":"burguer",style:{position:"relative",left:"10px"},onClick:function(e){console.log(e.target.parentElement),o((function(e){return!e})),console.log(n)}},s.a.createElement("div",{className:"bar1"}),s.a.createElement("div",{className:"bar2"}),s.a.createElement("div",{className:"bar3"})),s.a.createElement("ul",{className:n?"main-nav":"main-nav closed",id:"navContent"},s.a.createElement(f,{userPack:e.userPack}))):s.a.createElement(s.a.Fragment,null,s.a.createElement("h1",{className:"logo"},s.a.createElement("a",{className:"navTitle",href:"#"},"XVOICE")),s.a.createElement("ul",{className:"main-nav",id:"navContent"},s.a.createElement(f,{userPack:e.userPack})))))},N=function(e){var t=s.a.useState(!1),a=Object(g.a)(t,2),n=a[0],o=a[1],l=window.localStorage.getItem("username"),i=window.localStorage.getItem("password");l||(l=e.userPack.email,i=e.userPack.password);var r=s.a.useState(!0),c=Object(g.a)(r,2),m=c[0],d=c[1],u=s.a.useState(!1),h=Object(g.a)(u,2),p=h[0],E=h[1],v=s.a.useState(""),w=Object(g.a)(v,2),f=w[0],b=w[1],_=s.a.useState(""),k=Object(g.a)(_,2),N=k[0],S=k[1],y=n?"active":"",x=n?"":"active";return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"login-container",style:{marginBottom:"62px"}},s.a.createElement("div",{className:"form-login"},s.a.createElement("ul",{className:"login-nav"},s.a.createElement("li",{className:"login-nav__item "+x},s.a.createElement("a",{onClick:function(){o(!1)}},"Sign In")),s.a.createElement("li",{className:"login-nav__item "+y},s.a.createElement("a",{onClick:function(){o(!0)}},"Sign Up"))),s.a.createElement("label",{htmlFor:"login-input-user",className:"login__label"},"Email, Username or Phonenumber"),s.a.createElement("input",{id:"login-input-user",value:l,onChange:function(t){e.userPack.handleUpdate("email",t.target.value)},className:"login__input",type:"text"}),s.a.createElement("label",{htmlFor:"login-input-password",className:"login__label"},"Password"),s.a.createElement("input",{id:"login-input-password",value:i,onKeyPress:function(t){"Enter"===t.key&&e.userPack.handleLogin("","",m)},onChange:function(t){e.userPack.handleUpdate("password",t.target.value)},className:"login__input",type:"password"}),n?s.a.createElement(s.a.Fragment,null,s.a.createElement("label",{htmlFor:"login-input-user",className:"login__label"},"Nombre"),s.a.createElement("input",{id:"login-input-user",value:f,onChange:function(e){b(e.target.value)},className:"login__input",type:"text"}),s.a.createElement("label",{htmlFor:"login-input-user",className:"login__label"},"Celular"),s.a.createElement("input",{id:"login-input-user",value:N,onChange:function(e){var t=e.target.value;""===t&&S(t);try{var a=parseInt(t);if(isNaN(a))return}catch(n){return void console.log("error",n)}S(t.replace(/[^\d]+/g,""))},className:"login__input",type:"text"}),s.a.createElement("label",{htmlFor:"login-sign-up",className:"login__label--checkbox"},s.a.createElement("input",{id:"login-sign-up",type:"checkbox",checked:p,onChange:function(){E((function(e){return!e}))},className:"login__input--checkbox"}),"Estoy de acuerdo con las condiciones"),s.a.createElement("button",{className:"login__submit",onClick:function(){e.userPack.handleRegister(l,i,f,N)}},"Registrarme")):s.a.createElement(s.a.Fragment,null,s.a.createElement("label",{htmlFor:"login-sign-up",className:"login__label--checkbox"},s.a.createElement("input",{id:"login-sign-up",type:"checkbox",checked:m,onChange:function(){d((function(e){return!e}))},className:"login__input--checkbox"}),"Mantenme logueado"),s.a.createElement("button",{className:"login__submit",onClick:function(){e.userPack.handleLogin(l,i,m)}},"Entrar"))),s.a.createElement("a",{href:"#",className:"login__forgot"},"Forgot Password?")))},S=function(e){function t(e){var a;Object(r.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).toggleRegistration=function(e){e.target.classList.toggle("change"),document.querySelector("#navContent").classList.toggle("closed")},a.updateDimensions=function(){var e=window,t=document,n=t.documentElement,o=t.getElementsByTagName("body")[0],s=e.innerWidth||n.clientWidth||o.clientWidth,l=e.innerHeight||n.clientHeight||o.clientHeight;if(!(l-a.state.dimensions.height<60&&l-a.state.dimensions.height>0||s-a.state.dimensions.width===0))if(s<763){var i={width:s,height:l,isMobile:!0};a.setState({dimensions:i})}else{var r={width:s,height:l,isMobile:!1};a.setState({dimensions:r})}},a.getUser=function(){var e=window.localStorage.getItem("token");v.defaults.headers.get.Authorization="JWT "+e,v.get(E+"getSub/").then((function(e){a.setState({customer:e.data}),a.setState({loading:!1}),a.setState({logged:!0})})).catch((function(e){console.log("error",e),a.setState({loading:!1})}))},a.switchLoadingComponent=function(){var e=!a.state.loadingComponent;a.setState({loadingComponent:e})},a.handleUpdate=function(e,t){switch(window.localStorage.removeItem("username"),window.localStorage.removeItem("password"),e){case"email":a.setState({email:t});break;case"password":a.setState({password:t})}},a.handleLogin=function(e,t,n){a.setState({loading:!0});var o=a.state.email,s=a.state.password;n&&(window.localStorage.setItem("username",o),window.localStorage.setItem("password",s)),v.post(E+"token-auth/",{username:o,password:s}).then((function(e){window.localStorage.setItem("token",e.data.token),a.setState({customer:e.data.user});var t=!a.state.logged;a.setState({logged:t}),a.setState({loading:!1})})).catch((function(e){console.log("error",e),a.setState({loading:!1})}))},a.addDevice=function(){if(!(a.state.customer.subscribers.length>4)){var e=window.localStorage.getItem("token");v.defaults.headers.get.Authorization="JWT "+e,a.setState({loadingComponent:!0}),v.get(E+"addDevice/").then((function(e){a.setState({customer:e.data}),a.setState({loadingComponent:!1})}))}},a.deleteDevice=function(e){var t=window.localStorage.getItem("token");v.defaults.headers.get.Authorization="JWT "+t,a.setState({loadingComponent:!0}),v.post(E+"addDevice",{id:e}).then((function(e){a.setState({customer:e.data}),a.setState({loadingComponent:!1})}))},a.handleRegister=function(e,t,n,o){a.setState({loading:!0});var s=a.state.email,l=a.state.password;v.post(E+"newCustomer/",{email:s,password:l,name:n,phoneNumber:o}).then((function(e){e.data.id&&a.setState({customer:e.data});var t=!a.state.logged;a.setState({logged:t}),a.setState({loading:!1}),v.post(E+"token-auth/",{username:s,password:l}).then((function(e){window.localStorage.setItem("token",e.data.token)})).catch((function(e){console.log("error",e),a.setState({loading:!1})}))})).catch((function(e){console.log("error",e),a.setState({loading:!1})}))},a.handleLogout=function(){window.localStorage.removeItem("token"),window.localStorage.removeItem("userId"),window.localStorage.removeItem("username"),window.localStorage.removeItem("password"),a.setState({logged:!1})},window.addEventListener("resize",a.updateDimensions);var n=window,o=document,s=o.documentElement,l=o.getElementsByTagName("body")[0],i=n.innerWidth||s.clientWidth||l.clientWidth,c=n.innerHeight||s.clientHeight||l.clientHeight,u=!1,g=window.localStorage.getItem("token"),h=!1;console.log(p.host.substring(0,3)),"127"===p.host.substring(0,3)&&(h=!0),g&&(u=!0,a.getUser());var f=window.localStorage.getItem("username"),b=window.localStorage.getItem("password");return f||(f="",b=""),a.state={logged:h,dimensions:{width:i,height:c,isMobile:!1},loading:u,email:f,password:b,customer:w,loadingComponent:!1},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){this.updateDimensions()}},{key:"componentWillMount",value:function(){window.addEventListener("resize",this.updateDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateDimensions)}},{key:"render",value:function(){var e=this,t=[];this.state.customer.usageHistory.forEach((function(a){if("INVITE"===a.method){var n=e.state.customer.usageHistory.filter((function(e){return e.callid===a.callid&&"BYE"===e.method}))[0],o=new Date(a.time),s=(new Date(n.time).getTime()-o.getTime())/1e3,l={username:a.src_user,destination:a.dst_user,date:h(o,"mm/dd/yyyy, h:MM:ss TT"),duracion:s,costo:s*(.01/60)};t.push(l)}}));var a=this.state.dimensions.width<768,n=this.state.dimensions.isMobile?"15px":"50px",o={dimensions:this.state.dimensions,customer:this.state.customer,email:this.email,password:this.password,logged:this.state.logged,handleLogin:this.handleLogin,handleRegister:this.handleRegister,handleUpdate:this.handleUpdate,handleLogout:this.handleLogout,addDevice:this.addDevice,deleteDevice:this.deleteDevice};return s.a.createElement(s.a.Fragment,null,this.state.loading?s.a.createElement("div",{className:"row",style:{justifyContent:"center"}},s.a.createElement("div",{className:"lds-hourglass",style:{marginTop:"220px"}})):s.a.createElement(s.a.Fragment,null,this.state.logged?s.a.createElement(s.a.Fragment,null,s.a.createElement(k,{dimensions:this.state.dimensions,userPack:o}),s.a.createElement("div",{id:"mainBody",style:{marginLeft:n,marginRight:n,marginTop:"18px",marginBottom:"25px"}},s.a.createElement("div",{className:"row"},s.a.createElement("h1",{className:"mainTitle"},"Welcome ",this.state.customer.name)),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-xs-12 col-sm-4 caja",style:{maxHeight:"140px",paddingTop:"10px"}},s.a.createElement("div",{className:"row center"},s.a.createElement("h1",{className:"balance"},"$",this.state.customer.balance)),s.a.createElement("div",{className:"row center"},s.a.createElement("p",{className:"infoText"},"Saldo Actual")),s.a.createElement("div",{className:"row center",style:{marginTop:"5px"}},s.a.createElement("a",null,"Agregar saldo ")),s.a.createElement("div",{className:"row center",style:{marginTop:"5px"}},s.a.createElement("p",null," (ICQ 742481225)"))),s.a.createElement("div",{className:"col-xs-12 col-sm-7 caja",style:{marginLeft:a?"0px":.065*this.state.dimensions.width+"px",marginTop:a?"25px":"0px",paddingTop:"10px",paddingBottom:"10px"}},s.a.createElement("div",{className:"row center"},s.a.createElement("div",{className:"col-xs-auto"},s.a.createElement("h1",{className:"secondTitle",style:{marginBottom:"5px"}},"Mis dispositivos"),s.a.createElement("button",{onClick:this.addDevice,style:{marginLeft:"35px",width:"100px",position:"relative",bottom:"6px"},className:"pure-material-button-contained"},"Agregar"))),s.a.createElement("div",{className:"row center"},s.a.createElement("table",{id:"customers"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,"Usuario"),s.a.createElement("th",null,"Contrase\xf1a"),s.a.createElement("th",null,"IP"))),s.a.createElement("tbody",null,this.state.loadingComponent?s.a.createElement("div",{className:"row",style:{justifyContent:"center"}},s.a.createElement("div",{className:"col-xs-auto"},s.a.createElement("div",{className:"lds-hourglass",style:{marginLeft:"100%"}}))):s.a.createElement(s.a.Fragment,null,this.state.customer.subscribers.map((function(e,t){return s.a.createElement(b,{key:e.id,username:e.username,password:e.password})})))))))),s.a.createElement("div",{className:"col-xs-12 caja",style:{marginTop:"25px",overflowX:"visible"}},s.a.createElement("div",{className:"row"},s.a.createElement("h1",{className:"secondTitle",style:{padding:"8px"}},"Historial de llamadas")),s.a.createElement("div",{className:"row center"},s.a.createElement("table",{id:"customers",style:{overflowX:"auto !important"}},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,"Usuario"),s.a.createElement("th",null,"Destino"),s.a.createElement("th",null,"Fecha"),s.a.createElement("th",null,"Duraci\xf3n (segundos)"),s.a.createElement("th",null,"Costo"))),s.a.createElement("tbody",null,t.map((function(e,t){return s.a.createElement(_,{line:e,key:t})})))))))):s.a.createElement(N,{userPack:o})))}}]),t}(o.Component),y=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function x(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(s.a.createElement(S,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");y?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):x(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):x(t,e)}))}}()}},[[18,1,2]]]);
//# sourceMappingURL=main.9cfa9ea1.chunk.js.map